*项目文档 2022-04-19*

完成任务：修改政策标引录入模块（录入、编辑、删除、查看）

# 1、修改数据库表 policy_enter

```sql
/*
Navicat MySQL Data Transfer

Source Server         : reliable
Source Server Version : 80013
Source Host           : localhost:3306
Source Database       : febs

Target Server Type    : MYSQL
Target Server Version : 80013
File Encoding         : 65001

Date: 2022-04-19 09:11:03
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for policy_enter
-- ----------------------------
DROP TABLE IF EXISTS `policy_enter`;
CREATE TABLE `policy_enter` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '自增id',
  `publisher` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '发布人',
  `name` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '政策名称',
  `document_type` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '政策分类',
  `document_area` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '施行范围',
  `document_id` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '文号',
  `publish_type` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '颁布形式',
  `organ` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '制定机关',
  `pass_date` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '通过日期',
  `publish_date` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '公布日期',
  `exe_date` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '施行日期',
  `document_target` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '调整领域',
  `theme_words` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '主题词',
  `key_words` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '关键词',
  `up_document` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '上位政策',
  `pre_document` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '前驱政策',
  `post_document` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '后继政策',
  `document_state` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '时效状态',
  `sur_field` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL COMMENT '冗余字段',
  `text` text CHARACTER SET utf8 COLLATE utf8_general_ci COMMENT '政策正文',
  PRIMARY KEY (`id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=52 DEFAULT CHARSET=utf8 ROW_FORMAT=DYNAMIC;

-- ----------------------------
-- Records of policy_enter
-- ----------------------------
INSERT INTO `policy_enter` VALUES ('51', 'reliable', '新政策', '地方性法规', '山西省（140000 SX）', '001', '地方人民代表大会主席团或者常务委员会公告（地方性法规）', '国务院', '2022.04.19', '2022.04.29', '2022.04.30', '科技创新基地与平台', '1、2、3', '1、2、3、4、5', '01', '02', '03', '有效', '无', 'XXX');

```

**标引项目表**

| 标引                   |                         **项目内容**                         | **备注**       |
| ---------------------- | :----------------------------------------------------------: | -------------- |
| 政策名称               |                                                              |                |
| 政策分类               | 1、国家法律  2、行政法规  3、地方性法规  4、国务院部门规章  5、地方政府规章  6、国家非立法性文件  7、地方非立法性文件 |                |
| 施行范围               | 全国000000  地方（各省、市、自治区）  北京市（110000  BJ）  天津市（120000  TJ）  河北省（130000  HE）  山西省（140000  SX）  内蒙古自治区（150000 NM）  辽宁省（210000  LN）  吉林省（220000  JL）  黑龙江省（230000 HL）  上海市（310000  SH）  江苏省（320000  JS）  浙江省（330000  ZJ）  安徽省（340000  AH）  福建省（350000  FJ）  江西省（360000  JX）  山东省（370000  SD）  河南省（410000  HA）  湖北省（420000  HB）  湖南省（430000  HN）  广东省（440000  GD）  广西壮族自治区（450000 GX）  海南省（460000  HI）  重庆市（500000  CQ）  四川省（510000  SC）  贵州省（520000  GZ）  云南省（530000  YN）  西藏自治区（540000 XZ）  陕西省（610000  SN）  甘肃省（620000  GS）  青海省（630000  QH）  宁夏回族自治区（640000 NX）  新疆维吾尔自治区（650000 XJ）  台湾省（710000  Tw）  香港特别行政区（810000 HK）  澳门特别行政区（820000 Mo） |                |
| 序号或文号（发文字号） |                                                              |                |
| 颁布形式               | 1、国家主席令（法律）  2、国务院令（行政法规）  3、地方人民代表大会主席团或者常务委员会公告（地方性法规）  5、部门首长令（部门规章）  6、地方首长令（地方政府规章）  7、下发文件（非立法性文件） |                |
| 制定机关               | **国务院组成部门：**[外交部](http://www.fmprc.gov.cn/chn/)　[国防部](http://www.mod.gov.cn/)　[发展改革委](http://www.ndrc.gov.cn/)　[教育](http://www.moe.gov.cn/)[部](http://www.moe.gov.cn/)　[科技部](http://www.most.gov.cn/)　[工业和信息化部](http://www.miit.gov.cn/)　[国家民委](http://www.seac.gov.cn/)　[公安部](http://www.mps.gov.cn/)　安全部　[监察部](http://www.mos.gov.cn/)　[民政部](http://www.mca.gov.cn/)　[司法部](http://www.moj.gov.cn/)　[财政部](http://www.mof.gov.cn/)　[    人力资源社会保障部](http://www.mohrss.gov.cn/)　[国土资源部](http://www.mlr.gov.cn/)　[环境保护部](http://www.mep.gov.cn/)　[住房城乡建设部](http://www.mohurd.gov.cn/)　[交通运输部](http://www.moc.gov.cn/)　[铁道部](http://www.china-mor.gov.cn/)　[水利部](http://www.mwr.gov.cn/)　[农业部](http://www.agri.gov.cn/)　[商务部](http://www.mofcom.gov.cn/)　[文化部](http://www.ccnt.gov.cn/)　[卫生部](http://www.moh.gov.cn/)   [人口计生委](http://www.chinapop.gov.cn/)　[人民银行](http://www.pbc.gov.cn/)　[审计署](http://www.audit.gov.cn/)  **国务院直属特设机构：**[国资委](http://www.sasac.gov.cn/)  **国务院直属机构：**[海关总署](http://www.customs.gov.cn/)　[税务总局](http://www.chinatax.gov.cn/)　 [工商总局](http://www.saic.gov.cn/)　[质检总局](http://www.aqsiq.gov.cn/)　 [广电总局](http://www.chinasarft.gov.cn/)　 [新闻出版总署](http://www.gapp.gov.cn/)（[版权局](http://www.ncac.gov.cn/)）　 [体育总局](http://www.sport.gov.cn/)　[安全监管总局](http://www.chinasafety.gov.cn/)　 [统计局](http://www.stats.gov.cn/)　[林业局](http://www.forestry.gov.cn/)　   [知识产权局](http://www.sipo.gov.cn/)　[旅游局](http://www.cnta.gov.cn/)　 [宗教局](http://www.sara.gov.cn/)　[参事室](http://www.counsellor.gov.cn/)　[国管局](http://www.ggj.gov.cn/)　 [预防腐败局](http://yfj.mos.gov.cn/)  **国务院办事机构：**[侨办](http://www.gqb.gov.cn/) [港澳办](http://www.hmo.gov.cn/)　[法制办](http://www.chinalaw.gov.cn/) [国研室](http://www.gov.cn/gjjg/2005-12/26/content_137261.htm)  国务院直属事业单位：[新华社](http://www.xinhuanet.com/)　[中科院](http://www.cas.cn/)　[社科院](http://www.cass.net.cn/)　[工程院](http://www.cae.cn/) [发展研究中心](http://www.drc.gov.cn/)　[行政学院](http://www.nsa.gov.cn/)　[地震局](http://www.cea.gov.cn/)　[气象局](http://www.cma.gov.cn/)　[银监会](http://www.cbrc.gov.cn/)　[证监会](http://www.csrc.gov.cn/) [保监会](http://www.circ.gov.cn/)　 [电监会](http://www.serc.gov.cn/)　[社保基金会](http://www.ssf.gov.cn/)　 [    自然科学基金会](http://www.nsfc.gov.cn/)  **国务院部委管理的国家局：**[信访局](http://www.gjxfj.gov.cn/)　[粮食局](http://www.chinagrain.gov.cn/)　能源局　[国防科工局](http://www.costind.gov.cn/)　[烟草局](http://www.tobacco.gov.cn/)　[外专局](http://www.safea.gov.cn/) [公务员局](http://news.xinhuanet.com/newscenter/2008-10/30/content_10279339.htm)　[海洋局](http://www.soa.gov.cn/)　[测绘局](http://www.sbsm.gov.cn/)　[民航局](http://www.caac.gov.cn/)　[邮政局](http://www.post.gov.cn/)　 [文物局](http://www.sach.gov.cn/)　[食品药品监管局](http://www.sda.gov.cn/)   [中医药局](http://www.satcm.gov.cn/)　[外汇局](http://www.safe.gov.cn/)　 [煤矿安监局](http://www.chinasafety.gov.cn/mt-zuzhijigou.htm) |                |
| 通过日期               |                        2006年12月21日                        | （2006.12.21） |
| 公布日期               |                        2006年12月21日                        | （2006.12.21） |
| 施行日期               |                        2006年12月21日                        | （2006.12.21） |
| 调整领域（针对领域）   | 1、科技投入  2、税收激励  3、金融支持  4、政府采购  5、引进消化吸收再创新  6、创造和保护知识产权  7、人才队伍  8、教育与科普  9、科技创新基地与平台  10、加强统筹协调  11、其他 |                |
| 主题词                 |                            3—5个                             |                |
| 关键词                 |                            5—10个                            |                |
| 上位政策               |                                                              |                |
| 前驱政策               |                                                              |                |
| 后继政策               |                                                              |                |
| 时效状态               |                          有效、失效                          |                |
| 文件正文               |                           WORD文档                           |                |
| PDF文档                |                                                              |                |
| 冗余字段               |                                                              |                |

# 2、修改页面 policyCrawling

```html
<div class="layui-fluid layui-anim febs-anim" id="febs-dept" lay-title="政策录入">
    <div class="layui-card" style="text-align:right">
        <div class="layui-card-body">
            <button class="layui-btn layui-btn-normal" id="add" >添加</button>
        </div>
    </div>
    <div class="layui-col-md12 layui-col-sm12 layui-col-xs12" >
        <div class="layui-card">
            <table name="policylist" lay-filter="policyTable" lay-data="{id: 'policyTable'}"></table>
        </div>
    </div>
</div>

<script src="/layui/jquery-1.11.3.min.js"></script>
<script type="text/html" id="user-option">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm" lay-event="detail">查看</button>
        <button class="layui-btn layui-btn-sm" lay-event="update">编辑</button>
        <button class="layui-btn layui-btn-danger layui-btn-sm" lay-event="delete">删除</button>
    </div>
    <p id="uname" style="display: none"> {{ currentUser.username }} </p>
</script>
<script type="text/html" id="user-option1">
    <a lay-event="detail1" shiro:hasPermission="user:view"><i
            class="layui-icon febs-edit-area febs-green">&#xe7a5;</i></a>
</script>
<script data-th-inline="javascript" type="text/javascript">
    layui.use([ 'dropdown', 'jquery', 'validate', 'layer','febs', 'form', 'eleTree','element','table','apexcharts', 'jquery', 'util','layedit', 'echarts4', 'dataTool', 'echarts_gl'], function () {
        var $ = layui.jquery,
            febs = layui.febs,
            element = layui.element,
            layedit = layui.layedit,
            form = layui.form,
            table=layui.table,
            $viewa = $('#febs-index'),
            echarts = layui.echarts4,
            eleTree = layui.eleTree,
            dropdown = layui.dropdown,
            validate = layui.validate,
            $view = $('#febs-dept'),
            $query = $view.find('#query'),
            // $query = $view.find('#query'),
            // $reset = $view.find('#reset'),
            // $submit = $view.find('#submit'),
            // $header = $view.find('#form-header'),
            // $searchForm = $view.find('#dept-table-form'),
            _currentDeptData,
            tableIns,
            _deptTree;

        form.verify(validate);
        form.render();
        //initTable();

        febs.get(ctx + 'Enter/getFlag' , null, function (json) {
            var information=json.data.information;
            if(information!=0){
                window.alert(information);
            }
            initTable();
        });

        $("#add").click(function(){
            let name = $("#uname").text().trim();
            // alert(name);
            let htmlStr = "<form action='Enter/add' method='post' id='form' onsubmit='return check()'> "
                +"<div style='margin-top: 20px;margin-right: 30px'>"
                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>发布人</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' id='publisher'  name='publisher'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>政策名称</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='name' id='name'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>政策分类</label>"
                +"<div class='layui-input-block'>"
                +"<select tabindex=\"4\"  class=\"layui-input\"  name='documentType' id='documentType'>" +
                "<option disabled   style=\"display: none\" selected value>请选择</option>" +
                "<option value=\"国家法律\">国家法律</option>\n" +
                "<option value=\"行政法规\">行政法规</option>\n" +
                "<option value=\"地方性法规\">地方性法规</option>\n" +
                "<option value=\"国务院部门规章\">国务院部门规章</option>\n" +
                "<option value=\"地方政府规章\">地方政府规章</option>\n" +
                "<option value=\"国家非立法性文件\">国家非立法性文件</option>\n" +
                "<option value=\"地方非立法性文件\">地方非立法性文件</option>\n" +
                "</select>" +
                "</div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>施行范围</label>"
                +"<div class='layui-input-block'>"
                +"<select name=\"documentArea\" id=\"documentArea\" tabindex=\"4\"  class=\"layui-input\">\n" +
                "    <option value=\"全国（000000 QG）\">全国</option>\n" +
                "    <optgroup label=\"地方（各省、市、自治区）\">\n" +
                "        <option value=\"北京市（110000 BJ）\">北京市</option>\n" +
                "        <option value=\"河北省（130000 HE）\">河北省</option>\n" +
                "        <option value=\"山西省（140000 SX）\">山西省</option>\n" +
                "        <option value=\"内蒙古自治区（150000 NM）\">内蒙古自治区</option>\n" +
                "        <option value=\"辽宁省（210000 LN）\">辽宁省</option>\n" +
                "        <option value=\"吉林省（220000 JL）\">吉林省</option>\n" +
                "        <option value=\"黑龙江省（230000 HL）\">黑龙江省</option>\n" +
                "        <option value=\"上海市（310000 SH）\">上海市</option>\n" +
                "        <option value=\"江苏省（320000 JS）\">江苏省</option>\n" +
                "        <option value=\"浙江省（330000 ZJ）\">浙江省</option>\n" +
                "        <option value=\"安徽省（340000 AH）\">安徽省</option>\n" +
                "        <option value=\"福建省（350000 FJ）\">福建省</option>\n" +
                "        <option value=\"江西省（360000 JX）\">江西省</option>\n" +
                "        <option value=\"山东省（370000 SD）\">山东省</option>\n" +
                "        <option value=\"河南省（410000 HA）\">河南省</option>\n" +
                "        <option value=\"湖北省（420000 HB）\">湖北省</option>\n" +
                "        <option value=\"湖南省（430000 HN）\">湖南省</option>\n" +
                "        <option value=\"广东省（440000 GD）\">广东省</option>\n" +
                "        <option value=\"广西壮族自治区（450000 GX）\">广西壮族自治区</option>\n" +
                "        <option value=\"海南省（460000 HI）\">海南省</option>\n" +
                "        <option value=\"重庆市（500000 CQ）\">重庆市</option>\n" +
                "        <option value=\"四川省（510000 SC）\">四川省</option>\n" +
                "        <option value=\"贵州省（520000 GZ）\">贵州省</option>\n" +
                "        <option value=\"云南省（530000 YN）\">云南省</option>\n" +
                "        <option value=\"西藏自治区（540000 XZ）\">西藏自治区</option>\n" +
                "        <option value=\"陕西省（610000 SN）\">陕西省</option>\n" +
                "        <option value=\"甘肃省（620000 GS）\">甘肃省</option>\n" +
                "        <option value=\"青海省（630000 QH）\">青海省</option>\n" +
                "        <option value=\"宁夏回族自治区（640000 NX）\">宁夏回族自治区</option>\n" +
                "        <option value=\"新疆维吾尔自治区（650000 XJ）\">新疆维吾尔自治区</option>\n" +
                "        <option value=\"台湾省（710000 Tw）\">台湾省</option>\n" +
                "        <option value=\"香港特别行政区（810000 HK）\">香港特别行政区</option>\n" +
                "        <option value=\"澳门特别行政区（820000 MO）\">澳门特别行政区</option>\n" +
                "    </optgroup>\n" +
                "</select></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>序号或文号</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='documentId' id='documentId'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>颁布形式</label>"
                +"<div class='layui-input-block'>"
                +"<select class='layui-input'  name='publishType' id='publishType'>" +
                "<option  disabled   style=\"display: none\" selected value>请选择</option>" +
                "<option value=\"国家主席令（法律）\">国家主席令（法律）</option>\n" +
                "<option value=\"国务院令（行政法规）\">国务院令（行政法规）</option>\n" +
                "<option value=\"地方人民代表大会主席团或者常务委员会公告（地方性法规）\">地方人民代表大会主席团或者常务委员会公告（地方性法规）</option>\n" +
                "<option value=\"部门首长令（部门规章）\">部门首长令（部门规章）</option>\n" +
                "<option value=\"地方首长令（地方政府规章）\">地方首长令（地方政府规章）</option>\n" +
                "<option value=\"下发文件（非立法性文件）\">下发文件（非立法性文件）</option>\n" +
                "</select>" +
                "</div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>制定机关</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='organ' id='organ'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>通过日期</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='passDate' id='passDate' ></div></div>"
                +"<script>"
                +"layui.use('laydate', function(){\n" +
                "                        var laydate = layui.laydate;\n" +
                "                        //日期范围\n" +
                "                        laydate.render({\n" +
                "                            elem: '#passDate'\n" +
                "                            ,range: false\n" +
                "                            ,format:'yyyy.MM.dd'\n" +
                "                        });\n" +
                "                    });"
                +"</"+"script>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>公布日期</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='publishDate' id='publishDate' ></div></div>"
                +"<script>"
                +"layui.use('laydate', function(){\n" +
                "                        var laydate = layui.laydate;\n" +
                "                        //日期范围\n" +
                "                        laydate.render({\n" +
                "                            elem: '#publishDate'\n" +
                "                            ,range: false\n" +
                "                            ,format:'yyyy.MM.dd'\n" +
                "                        });\n" +
                "                    });"
                +"</"+"script>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>施行日期</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='exeDate' id='exeDate' ></div></div>"
                +"<script>"
                +"layui.use('laydate', function(){\n" +
                "                        var laydate = layui.laydate;\n" +
                "                        //日期范围\n" +
                "                        laydate.render({\n" +
                "                            elem: '#exeDate'\n" +
                "                            ,range: false\n" +
                "                            ,format:'yyyy.MM.dd'\n" +
                "                        });\n" +
                "                    });"
                +"</"+"script>"


                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>调整领域</label>"
                +"<div class='layui-input-block'>"
                +"<select class='layui-input'  name='documentTarget' id='documentTarget'>" +
                "<option  disabled   style=\"display: none\" selected value>请选择</option>" +
                "<option value=\"科技投入\">科技投入</option>\n" +
                "<option value=\"税收激励\">税收激励</option>\n" +
                "<option value=\"金融支持\">金融支持</option>\n" +
                "<option value=\"政府采购\">政府采购</option>\n" +
                "<option value=\"引进消化吸收再创新\">引进消化吸收再创新</option>\n" +
                "<option value=\"人才队伍\">人才队伍</option>\n" +
                "<option value=\"教育与科普\">教育与科普</option>\n" +
                "<option value=\"科技创新基地与平台\">科技创新基地与平台</option>\n" +
                "<option value=\"加强统筹协调\">加强统筹协调</option>\n" +
                "<option value=\"其他\">其他</option>\n" +
                "</select>" +
                "</div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>主题词</label>"
                +"<div class='layui-input-block'>"
                +"<input placeholder='3 ~ 5 个' class='layui-input' type='text' name='themeWords' id='themeWords'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>关键词</label>"
                +"<div class='layui-input-block'>"
                +"<input placeholder='5 ~ 10 个' class='layui-input' type='text' name='keyWords' id='keyWords'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>上位政策</label>"
                +"<div class='layui-input-block'>"
                +"<input  class='layui-input' type='text' name='upDocument' id='upDocument'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>前驱政策</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='preDocument' id='preDocument'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>后继政策</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='postDocument' id='postDocument'></div></div>"

                +"<div class=\"layui-form-item\">"
                +"<label class=\"layui-form-label\">时效状态</label>"
                +"<div class=\"layui-input-block\" style='font-size: 14px'>"
                +"<input type=\"radio\" name=\"documentState\" id=\"documentState\" value=\"有效\" title=\"有效\">有效<br>"
                +"<input type=\"radio\" name=\"documentState\" id=\"documentState\" value=\"失效\" title=\"失效\">无效"
                +"</div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>冗余字段</label>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='text' name='surField' id='surField'></div></div>"

                +"<div class='layui-form-item'>"
                +"<label class='layui-form-label'>政策内容</label>"
                +"<div class='layui-input-block'>"
                +"<textarea id=\"demo\" style=\"display: none;\" name='text' id='text'></textarea></div></div>"

                +"<div class='layui-form-item'>"
                +"<div class='layui-input-block'>"
                +"<input class='layui-input' type='submit' value='提交' ></div></div>"

                +"<script>"
                +"layui.use('layedit', function(){\n" +
                "    var layedit = layui.layedit;\n" +
                "    layedit.build('demo');   //建立编辑器\n" +
                "    layedit.set({\n" +
                "        //暴露layupload参数设置接口 --详细查看layupload参数说明\n" +
                "        uploadImage: {\n" +
                "            url: ''    //上传接口url\n" +
                "            ,type: 'post' //默认post\n" +
                "        }\n" +
                "        , devmode: true\n" +
                "        //插入代码设置\n" +
                "        , codeConfig: {\n" +
                "            hide: true,  //是否显示编码语言选择框\n" +
                "            default: 'javascript' //hide为true时的默认语言格式\n" +
                "        }\n" +
                "        , tool: [\n" +
                "            'html', 'code', 'strong',  'underline', 'del', 'addhr', '|', 'fontFomatt', 'colorpicker', 'face'\n" +
                "            , '|', 'left', 'center', 'right', '|', 'link', 'unlink','images', 'image_alt',\n" +
                "            , '|', 'fullScreen'\n" +
                "        ]\n" +
                "        ,height: 500, //设置编辑器高度\n" +
                "    });\n" +
                "});"
                +"</"+"script>"
                +"</div></form>"
                +"<script>"
                +"function check() {"
                +"let name = document.getElementById('name').value;if(name.length==0){alert('政策名称不能为空！');return false;}"
                +"let doc = document.getElementById('documentId').value;if(doc.length==0){alert('政策文号不能为空！');return false;}"
                +"let sub = document.getElementById('themeWords').value;if(sub.length==0){alert('主题词不能为空！');return false;}"
                +"let organ = document.getElementById('organ').value;if(organ.length==0){alert('制定机关不能为空！');return false;}"
                +"let year = document.getElementById('exeDate').value;if(year.length==0){alert('施行日期不能为空！');return false;}"
                +"}"
                +"</"+"script>"

            addform = layer.open({
                type: 1,
                title:"录入政策",
                area:['90%','95%'],
                content: htmlStr,
                yes:function(index,layero){

                }
            });
        })

        $view.on('click', '#submit', function () {
            $view.find('#submit-form').trigger('click');
        });
        function tanchuang()
        {
            febs.modal.view('正在加载', 'policy/jindutiao', {
                area: $(window).width() <= 400 ? '45%' : '40%'
            });
        }


        form.on('submit(dept-form-submit)', function (data) {
            //tanchuang();
            febs.get(ctx + 'Crawling/getPolicy' , null, function (json) {
                var information=json.data.information;
                window.alert(information);
                initTable();
            });

            return false;

        });
        $query.on('click', function () {
            febs.get(ctx + 'Crawling/intoPolicy' , null, function (json) {
                var information=json.data.information;
                window.alert(information);

            });
        });
        function initTable() {
            tableIns = febs.table.init({
                elem: $view.find('table'),
                id: 'policyTable',
                skin:'line',
                even:true,
                url: ctx + 'Enter/list',
                cols: [
                    [
                        {field: 'name', title: '政策名称', minWidth: 400},
                        {field: 'publishDate', title: '发布日期'},
                        {field: 'publisher', title: '发布人'},
                        {field: 'organ', title: '发布机构'},
                        {title: '操作', toolbar: '#user-option', minWidth: 150}
                    ]
                ]
            });
        }
        table.on('tool(policyTable)', function (obj) {
            var data = obj.data,
                layEvent = obj.event;
            if (layEvent === 'detail') {
                febs.modal.view('政策信息', 'policy/detailCrawling/' + data.id, {
                    area: $(window).width() <= 850 ? '95%' : '80%'
                });
            }else if(layEvent === 'delete'){
                febs.get(ctx + 'Enter/deleteP?id='+data.id , null, function (json) {
                    var information=json.data.information;
                    window.alert(information);
                    tableIns.reload('LAY-user-table');
                });
            }else if(layEvent === 'update'){
                febs.get(ctx + 'Enter/findById?id='+data.id , null, function (json) {
                    var policy=json.data;
                    let htmlStr = "<form action='Enter/update' method='post' id='form'>"
                        +"<input type='text' name='id' style='display: none' value='"+policy.id+"'>"
                        +"<div style='margin-top: 20px;margin-right: 30px'>"
                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>发布人</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text'  name='publisher' id='publisher' value='"+policy.publisher+"'></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>政策名称</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='name' id='name' value='"+policy.name+"'></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>政策分类</label>"
                        +"<div class='layui-input-block'>"
                        +"<select tabindex=\"4\" class='layui-input'  name='documentType' id='documentType'>" +
                        "<option  disabled   style=\"display: none\" selected value>请选择</option>" +
                        "<option value=\"国家法律\">国家法律</option>\n" +
                        "<option value=\"行政法规\">行政法规</option>\n" +
                        "<option value=\"地方性法规\">地方性法规</option>\n" +
                        "<option value=\"国务院部门规章\">国务院部门规章</option>\n" +
                        "<option value=\"地方政府规章\">地方政府规章</option>\n" +
                        "<option value=\"国家非立法性文件\">国家非立法性文件</option>\n" +
                        "<option value=\"地方非立法性文件\">地方非立法性文件</option>\n" +
                        "</select>" +
                        "</div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>施行范围</label>"
                        +"<div class='layui-input-block'>"
                        +"<select name=\"documentArea\" id=\"documentArea\" tabindex=\"4\"  class=\"layui-input\">\n" +
                        "    <option value=\"全国（000000 QG）\">全国</option>\n" +
                        "    <optgroup label=\"地方（各省、市、自治区）\">\n" +
                        "        <option value=\"北京市（110000 BJ）\">北京市</option>\n" +
                        "        <option value=\"河北省（130000 HE）\">河北省</option>\n" +
                        "        <option value=\"山西省（140000 SX）\">山西省</option>\n" +
                        "        <option value=\"内蒙古自治区（150000 NM）\">内蒙古自治区</option>\n" +
                        "        <option value=\"辽宁省（210000 LN）\">辽宁省</option>\n" +
                        "        <option value=\"吉林省（220000 JL）\">吉林省</option>\n" +
                        "        <option value=\"黑龙江省（230000 HL）\">黑龙江省</option>\n" +
                        "        <option value=\"上海市（310000 SH）\">上海市</option>\n" +
                        "        <option value=\"江苏省（320000 JS）\">江苏省</option>\n" +
                        "        <option value=\"浙江省（330000 ZJ）\">浙江省</option>\n" +
                        "        <option value=\"安徽省（340000 AH）\">安徽省</option>\n" +
                        "        <option value=\"福建省（350000 FJ）\">福建省</option>\n" +
                        "        <option value=\"江西省（360000 JX）\">江西省</option>\n" +
                        "        <option value=\"山东省（370000 SD）\">山东省</option>\n" +
                        "        <option value=\"河南省（410000 HA）\">河南省</option>\n" +
                        "        <option value=\"湖北省（420000 HB）\">湖北省</option>\n" +
                        "        <option value=\"湖南省（430000 HN）\">湖南省</option>\n" +
                        "        <option value=\"广东省（440000 GD）\">广东省</option>\n" +
                        "        <option value=\"广西壮族自治区（450000 GX）\">广西壮族自治区</option>\n" +
                        "        <option value=\"海南省（460000 HI）\">海南省</option>\n" +
                        "        <option value=\"重庆市（500000 CQ）\">重庆市</option>\n" +
                        "        <option value=\"四川省（510000 SC）\">四川省</option>\n" +
                        "        <option value=\"贵州省（520000 GZ）\">贵州省</option>\n" +
                        "        <option value=\"云南省（530000 YN）\">云南省</option>\n" +
                        "        <option value=\"西藏自治区（540000 XZ）\">西藏自治区</option>\n" +
                        "        <option value=\"陕西省（610000 SN）\">陕西省</option>\n" +
                        "        <option value=\"甘肃省（620000 GS）\">甘肃省</option>\n" +
                        "        <option value=\"青海省（630000 QH）\">青海省</option>\n" +
                        "        <option value=\"宁夏回族自治区（640000 NX）\">宁夏回族自治区</option>\n" +
                        "        <option value=\"新疆维吾尔自治区（650000 XJ）\">新疆维吾尔自治区</option>\n" +
                        "        <option value=\"台湾省（710000 Tw）\">台湾省</option>\n" +
                        "        <option value=\"香港特别行政区（810000 HK）\">香港特别行政区</option>\n" +
                        "        <option value=\"澳门特别行政区（820000 MO）\">澳门特别行政区</option>\n" +
                        "    </optgroup>\n" +
                        "</select></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>序号或文号</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='documentId' id='documentId' value='"+policy.documentId+"'> </div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>颁布形式</label>"
                        +"<div class='layui-input-block'>"
                        +"<select class='layui-input'  name='publishType' id='publishType'>" +
                        "<option  disabled   style=\"display: none\" selected value>请选择</option>" +
                        "<option value=\"国家主席令（法律）\">国家主席令（法律）</option>\n" +
                        "<option value=\"国务院令（行政法规）\">国务院令（行政法规）</option>\n" +
                        "<option value=\"地方人民代表大会主席团或者常务委员会公告（地方性法规）\">地方人民代表大会主席团或者常务委员会公告（地方性法规）</option>\n" +
                        "<option value=\"部门首长令（部门规章）\">部门首长令（部门规章）</option>\n" +
                        "<option value=\"地方首长令（地方政府规章）\">地方首长令（地方政府规章）</option>\n" +
                        "<option value=\"下发文件（非立法性文件）\">下发文件（非立法性文件）</option>\n" +
                        "</select>" +
                        "</div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>制定机关</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='organ' id='organ' value='"+policy.organ+"'></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>通过日期</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='passDate' id='passDate' value='"+policy.passDate+"'></div></div>"
                        +"<script>"
                        +"layui.use('laydate', function(){\n" +
                        "                        var laydate = layui.laydate;\n" +
                        "                        //日期范围\n" +
                        "                        laydate.render({\n" +
                        "                            elem: '#passDate'\n" +
                        "                            ,range: false\n" +
                        "                            ,format:'yyyy.MM.dd'\n" +
                        "                        });\n" +
                        "                    });"
                        +"</"+"script>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>公布日期</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='publishDate' id='publishDate' value='"+policy.publishDate+"'></div></div>"
                        +"<script>"
                        +"layui.use('laydate', function(){\n" +
                        "                        var laydate = layui.laydate;\n" +
                        "                        //日期范围\n" +
                        "                        laydate.render({\n" +
                        "                            elem: '#publishDate'\n" +
                        "                            ,range: false\n" +
                        "                            ,format:'yyyy.MM.dd'\n" +
                        "                        });\n" +
                        "                    });"
                        +"</"+"script>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>施行日期</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='exeDate' id='exeDate' value='"+policy.exeDate+"'></div></div>"
                        +"<script>"
                        +"layui.use('laydate', function(){\n" +
                        "                        var laydate = layui.laydate;\n" +
                        "                        //日期范围\n" +
                        "                        laydate.render({\n" +
                        "                            elem: '#exeDate'\n" +
                        "                            ,range: false\n" +
                        "                            ,format:'yyyy.MM.dd'\n" +
                        "                        });\n" +
                        "                    });"
                        +"</"+"script>"


                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>调整领域</label>"
                        +"<div class='layui-input-block'>"
                        +"<select class='layui-input'  name='documentTarget' id='documentTarget'>" +
                        "<option  disabled   style=\"display: none\" selected value>请选择</option>" +
                        "<option value=\"科技投入\">科技投入</option>\n" +
                        "<option value=\"税收激励\">税收激励</option>\n" +
                        "<option value=\"金融支持\">金融支持</option>\n" +
                        "<option value=\"政府采购\">政府采购</option>\n" +
                        "<option value=\"引进消化吸收再创新\">引进消化吸收再创新</option>\n" +
                        "<option value=\"人才队伍\">人才队伍</option>\n" +
                        "<option value=\"教育与科普\">教育与科普</option>\n" +
                        "<option value=\"科技创新基地与平台\">科技创新基地与平台</option>\n" +
                        "<option value=\"加强统筹协调\">加强统筹协调</option>\n" +
                        "<option value=\"其他\">其他</option>\n" +
                        "</select>" +
                        "</div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>主题词</label>"
                        +"<div class='layui-input-block'>"
                        +"<input placeholder='3 ~ 5 个' class='layui-input' type='text' name='themeWords' id='themeWords' value='"+policy.themeWords+"'></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>关键词</label>"
                        +"<div class='layui-input-block'>"
                        +"<input placeholder='5 ~ 10 个' class='layui-input' type='text' name='keyWords' id='keyWords' value='"+policy.keyWords+"'></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>上位政策</label>"
                        +"<div class='layui-input-block'>"
                        +"<input  class='layui-input' type='text' name='upDocument' id='upDocument' value='"+policy.upDocument+"'></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>前驱政策</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='preDocument' id='preDocument' value='"+policy.preDocument+"' ></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>后继政策</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='postDocument' id='postDocument' value='"+policy.postDocument+"'></div></div>"

                        +"<div class=\"layui-form-item\">"
                        +"<label class=\"layui-form-label\">时效状态</label>"
                        +"<div class=\"layui-input-block\" style='font-size: 14px'>"
                        +"<input type=\"radio\" name=\"documentState\" id=\"documentState\" value=\"有效\" title=\"有效\">有效<br>"
                        +"<input type=\"radio\" name=\"documentState\" id=\"documentState\" value=\"失效\" title=\"失效\">无效"
                        +"</div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>冗余字段</label>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='text' name='surField' id='surField' value='"+policy.surField+"'></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<label class='layui-form-label'>政策内容</label>"
                        +"<div class='layui-input-block'>"
                        +"<textarea id=\"demo1\" style=\"display: none;\" name='text' id='text'>"+policy.text+"</textarea></div></div>"

                        +"<div class='layui-form-item'>"
                        +"<div class='layui-input-block'>"
                        +"<input class='layui-input' type='submit' value='提交' ></div></div>"

                        +"<script>"
                        +"layui.use('layedit', function(){\n" +
                        "    var layedit = layui.layedit;\n" +
                        "    layedit.build('demo1');   //建立编辑器\n" +
                        "    layedit.set({\n" +
                        "        //暴露layupload参数设置接口 --详细查看layupload参数说明\n" +
                        "        uploadImage: {\n" +
                        "            url: ''    //上传接口url\n" +
                        "            ,type: 'post' //默认post\n" +
                        "        }\n" +
                        "        , devmode: true\n" +
                        "        //插入代码设置\n" +
                        "        , codeConfig: {\n" +
                        "            hide: true,  //是否显示编码语言选择框\n" +
                        "            default: 'javascript' //hide为true时的默认语言格式\n" +
                        "        }\n" +
                        "        , tool: [\n" +
                        "            'html', 'code', 'strong',  'underline', 'del', 'addhr', '|', 'fontFomatt', 'colorpicker', 'face'\n" +
                        "            , '|', 'left', 'center', 'right', '|', 'link', 'unlink','images', 'image_alt',\n" +
                        "            , '|', 'fullScreen'\n" +
                        "        ]\n" +
                        "        ,height: 500, //设置编辑器高度\n" +
                        "    });\n" +
                        "});"
                        +"</"+"script>"
                        +"</div></form>"
                    addform = layer.open({
                        type: 1,
                        title:"修改政策",
                        area:['90%','95%'],
                        content: htmlStr,
                        yes:function(index,layero){

                        }
                    });

                    var documentTypeNum = document.getElementById("documentType").options;
                    for(var i=0;i<documentTypeNum.length;i++){//给select赋值
                        if(documentTypeNum[i].value==policy.documentType){
                            documentTypeNum[i].selected=true
                        }
                    }
                    var publishTypeNum = document.getElementById("publishType").options;
                    for(var i=0;i<publishTypeNum.length;i++){//给select赋值
                        //alert(t[i].value);
                        if(publishTypeNum[i].value==policy.publishType){
                            publishTypeNum[i].selected=true
                        }
                    }

                    var documentTargetNum=document.getElementById("documentTarget").options;

                    for(var i=0;i<documentTargetNum.length;i++){//给select赋值
                        //alert(t[i].value);
                        if(documentTargetNum[i].value==policy.documentTarget){
                            documentTargetNum[i].selected=true
                        }
                    }
                    var documentAreaNum=document.getElementById("documentArea").options;

                    for(var i=0;i<documentAreaNum.length;i++){//给select赋值
                        //alert(t[i].value);
                        if(documentAreaNum[i].value==policy.documentArea){
                            documentAreaNum[i].selected=true
                        }
                    }
                    var state = document.getElementsByName('documentState')
                    for (var i =0 ;i<state.length;i++)
                    {
                        if(state[i].value==policy.documentState){
                            state[i].checked=true
                        }
                    }
                });
            }
        });
    });
</script>
```

## 小结：

> ```html
> <option disabled   style=\"display: none\" selected value>请选择</option>
> 实现下拉框默认显示提示词（该值不可选）
> <optgroup label="地方（各省、市、自治区）">
> 分组下拉框
> 
> id 等命名采用驼峰式
>  
> 日期输入
>     +"<div class='layui-form-item'>"
>                 +"<label class='layui-form-label'>施行日期</label>"
>                 +"<div class='layui-input-block'>"
>                 +"<input class='layui-input' type='text' name='exeDate' id='exeDate' ></div></div>"
>                 +"<script>"
>                 +"layui.use('laydate', function(){\n" +
>                 "                        var laydate = layui.laydate;\n" +
>                 "                        //日期范围\n" +
>                 "                        laydate.render({\n" +
>                 "                            elem: '#exeDate'\n" +
>                 "                            ,range: false\n" +
>                 "                            ,format:'yyyy.MM.dd'\n" +
>                 "                        });\n" +
>                 "                    });"
>                 +"</"+"script>"
> 
> 设置单选框默认选中（和读取到的数据对比）
> var state = document.getElementsByName('documentState')
>                     for (var i =0 ;i<state.length;i++)
>                     {
>                         if(state[i].value==policy.documentState){
>                             state[i].checked=true
>                         }
>                     }
>     
> 设置下拉框默认选中（和读取到的数据对比）
> var documentTargetNum=document.getElementById("documentTarget").options;
> 
>                     for(var i=0;i<documentTargetNum.length;i++){//给select赋值
>                         //alert(t[i].value);
>                         if(documentTargetNum[i].value==policy.documentTarget){
>                             documentTargetNum[i].selected=true
>                         }
>                     }
> ```



----



# 3、修改mapper PolicyEnterMapper

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cc.mrbird.febs.policy.mapper.PolicyEnterMapper">
    <sql id="findPolicyDetailSql">
        SELECT
        p.id,
        p.publisher,
        p.name,
        p.document_type,
        p.document_area,
        p.document_id,
        p.publish_type,
        p.organ,
        p.pass_date,
        p.publish_date,
        p.exe_date,
        p.document_target,
        p.theme_words,
        p.key_words,
        p.up_document,
        p.pre_document,
        p.post_document,
        p.document_state,
        p.sur_field,
        p.text
        FROM
        policy_enter p
        WHERE 1 = 1
    </sql>
    <select id="getPolicyCrawlingList" parameterType="PolicyEnter" resultType="PolicyEnter">
        SELECT
        p.id,
        p.publisher,
        p.name,
        p.document_type,
        p.document_area,
        p.document_id,
        p.publish_type,
        p.organ,
        p.pass_date,
        p.publish_date,
        p.exe_date,
        p.document_target,
        p.theme_words,
        p.key_words,
        p.up_document,
        p.pre_document,
        p.post_document,
        p.document_state,
        p.sur_field,
        p.text
        FROM
        policy_enter p
        WHERE 1 = 1

    </select>
    <select id="findPolicyDetailPage" parameterType="PolicyEnter" resultType="PolicyEnter">
        <include refid="findPolicyDetailSql"/>
    </select>
    <select id="findById" parameterType="int" resultType="PolicyEnter">
        SELECT
        p.id,
        p.publisher,
        p.name,
        p.document_type,
        p.document_area,
        p.document_id,
        p.publish_type,
        p.organ,
        p.pass_date,
        p.publish_date,
        p.exe_date,
        p.document_target,
        p.theme_words,
        p.key_words,
        p.up_document,
        p.pre_document,
        p.post_document,
        p.document_state,
        p.sur_field,
        p.text
        FROM
        policy_enter p
        WHERE p.id = #{policyId}
    </select>
</mapper>
```

> 注意：这里的sql语句要和数据库表结构对应（字段名）

# 4、修改实体类 PolicyEnter

```java
package cc.mrbird.febs.policy.entity;

import java.util.Date;

import lombok.Data;
import com.baomidou.mybatisplus.annotation.IdType;
import com.baomidou.mybatisplus.annotation.TableField;
import com.baomidou.mybatisplus.annotation.TableId;
import com.baomidou.mybatisplus.annotation.TableName;

/**
 *  Entity
 *
 * @author WangRenyi
 * @date 2022-04-03 11:42:16
 */
@Data
@TableName("policy_enter")
public class PolicyEnter {
    /**
     * 
     */
    @TableId(value = "id", type = IdType.AUTO)
    private Integer id;

    /**
     * 发布人
     */
    @TableField("publisher")
    private String publisher;

    /**
     * 
     */
    @TableField("name")
    private String name;

    /**
     * 
     */
    @TableField("document_type")
    private String documentType;

    /**
     * 
     */
    @TableField("document_area")
    private String documentArea;

    /**
     * 
     */
    @TableField("document_id")
    private String documentId;

    /**
     * 
     */
    @TableField("publish_type")
    private String publishType;

    /**
     * 
     */
    @TableField("organ")
    private String organ;

    /**
     * 
     */
    @TableField("pass_date")
    private String passDate;

    /**
     * 
     */
    @TableField("publish_date")
    private String publishDate;

    /**
     * 
     */
    @TableField("exe_date")
    private String exeDate;

    @TableField("document_target")
    private String documentTarget;

    @TableField("theme_words")
    private String themeWords;

    @TableField("key_words")
    private String keyWords;

    @TableField("up_document")
    private String upDocument;

    @TableField("pre_document")
    private String preDocument;

    @TableField("post_document")
    private String postDocument;

    @TableField("document_state")
    private String documentState;
    @TableField("sur_field")
    private String surField;

    @TableField("text")
    private String text;

    @Override
    public String toString() {
        return "PolicyEnter{" +
                "id=" + id +
                ", publisher='" + publisher + '\'' +
                ", name='" + name + '\'' +
                ", documentType='" + documentType + '\'' +
                ", documentArea='" + documentArea + '\'' +
                ", documentId='" + documentId + '\'' +
                ", publishType='" + publishType + '\'' +
                ", organ='" + organ + '\'' +
                ", passDate='" + passDate + '\'' +
                ", publishDate='" + publishDate + '\'' +
                ", exeDate='" + exeDate + '\'' +
                ", documentTarget='" + documentTarget + '\'' +
                ", themeWords='" + themeWords + '\'' +
                ", keyWords='" + keyWords + '\'' +
                ", upDocument='" + upDocument + '\'' +
                ", preDocument='" + preDocument + '\'' +
                ", postDocument='" + postDocument + '\'' +
                ", documentState='" + documentState + '\'' +
                ", surField='" + surField + '\'' +
                ", text='" + text + '\'' +
                '}';
    }


}
```

# 5、修改查看页 policyDetailCrawling

```html
<style>
    #febs-policy-detail #user-img, #febs-policy-detail .user-info {
        display: inline-block;
        float: left;
        margin-left: 15px;
    }

    #febs-policy-detail #user-img img {
        width: 7rem;
        margin: 10px 10px 0 20px;
        border-radius: 50%;
        cursor: pointer;
    }

    #febs-policy-detail #user-info-wrapper {
        margin: 0 0 1rem 0;
        display: inline-block;
    }

    #febs-policy-detail .user-info div {
        margin: 10px 15px;
        /*max-width: 19rem;*/
    }

    #febs-policy-detail #options-wrapper a {
        padding: 4px 6px;
        color: rgba(0, 0, 0, 0.65);
        border: 1px solid #d9d9d9;
        border-radius: 2px;
    }

    #febs-policy-detail #options-wrapper a:hover {
        color: #40a9ff;
        border-color: #40a9ff;
    }
    .policyName {
        font-size: 20px;
        font-weight: bold;
        color: #000000;
    }
</style>
<div class="layui-fluid" id="febs-policy-detail" lay-title="政策信息">
    <div id="user-info-wrapper">
        <div class="user-info">
            <div align="center" class="policyName">
                [[${policy.name}]]
            </div>
            <div><span class="layui-icon layui-icon-mail"></span> 文号：
                [[${#strings.defaultString(policy.documentId,'无文号')}]]
            </div>
            <div id="content" class="layui-icon">
                [[${policy.text}]]
            </div>
        </div>
    </div>

</div>
<script>
    layui.use(['febs'], function () {
        var $ = layui.jquery;
        var content = $("#content").text();
        console.log(content);
        $("#content").empty();
        var splitedText = content.split('\n');
        // console.log(splitedText);
        for (var part in splitedText) {
            $("#content").append('<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + splitedText[part] + '</p>')
        }
    });
</script>
```

> 修改页面主要注意变量名要对应正确（policy.documentId）

# 6、修改service PolicyEnterServiceImpl

```java
package cc.mrbird.febs.policy.service.impl;
import cc.mrbird.febs.common.entity.FebsConstant;
import cc.mrbird.febs.common.entity.QueryRequest;
import cc.mrbird.febs.common.utils.SortUtil;
import cc.mrbird.febs.policy.entity.PolicyCrawling;
import cc.mrbird.febs.policy.entity.PolicyEnter;
import cc.mrbird.febs.policy.mapper.PolicyCrawlingMapper;
import cc.mrbird.febs.policy.mapper.PolicyEnterMapper;
import cc.mrbird.febs.policy.service.IPolicyCrawlingService;
import cc.mrbird.febs.policy.service.IPolicyEnterService;
import com.baomidou.mybatisplus.core.metadata.IPage;
import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
import com.baomidou.mybatisplus.extension.service.impl.ServiceImpl;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Propagation;
import org.springframework.transaction.annotation.Transactional;
import java.util.List;
@Service
@Transactional(propagation = Propagation.SUPPORTS, readOnly = true, rollbackFor = Exception.class)
public class PolicyEnterServiceImpl extends ServiceImpl<PolicyEnterMapper, PolicyEnter> implements IPolicyEnterService {
    @Override
    public IPage<PolicyEnter> findPolicyCrawlingDetail(PolicyEnter policy, QueryRequest request) {
        Page<PolicyEnter> page = new Page<>(request.getPageNum(), request.getPageSize());
        SortUtil.handlePageSort(request, page, "exe_date", FebsConstant.ORDER_DESC, false);
        return this.baseMapper.findPolicyDetailPage(page, policy);
    }
    @Override
    @Transactional
    public void createPolicyCrawling(PolicyEnter policy) {
        this.baseMapper.insert(policy);
    }
    @Override
    @Transactional
    public void deletePolicyCrawling(int id) {
        this.baseMapper.deleteById(id);
    }

    @Override
    public void updatePolicyCrawling(PolicyEnter id) {
        this.baseMapper.updateById(id);
    }

    @Override
    public List<PolicyEnter> getPolicyCrawlingList(){return this.baseMapper.getPolicyCrawlingList();}
    @Override
    public PolicyEnter findById(int policyId) {
        return this.baseMapper.findById(policyId);
    }
}
```

> 修改参数exe_date和页面id一致 ： SortUtil.handlePageSort(request, page, "exe_date", FebsConstant.ORDER_DESC, false); 



# 7、bug描述



问题描述：实体类属性注解 @TableField 无法获取到数据库的值

实体类变量的命名格式

如果采用的是 **XX_XX带下划线的形式**，那么在低版本的mybatis-plus是不支持和数据库映射的。

如果是单个单词不存在这个问题，如果出现多个单词，尽量采用**驼峰式命名**来规避此问题！

**@TableField** 会自动将数据库中的下划线命名风格转化为实体类中的驼峰命名风格！

![img](变更文档 2022-04-19/2090080-20220418214703280-933149597.png)

 

![img](变更文档 2022-04-19/2090080-20220418214805973-2145930327.png)

 

![img](变更文档 2022-04-19/2090080-20220418214811190-429768305.png)

如上两张图所示，**此时我的类的变量命名比如 document_type是带下划线的，那么在执行sql语句的时候，这些属性值是无法与数据库的属性正常映射的！**

而id、name等不带下划线的属性值则可以正常读取到！

----

==数据库的列名，一般会带下划线：比如document_type==

==而在Java中，一般对实体类属性名的命名采用驼峰式，比如：documentType==

==所以mybatis-plus为了解决这一冲突，在使用@TableFeild注解时，为了正确完成数据表列名和实体类属性名的映射，所以==

==在读取到数据库的数据后，会自动把数据库的列名转化为驼峰式命名再映射到实体类的属性，我遇到的问题是，数据列采用==

==下划线命名格式，实体类也使用下划线，所以在读到数据之后由于数据列被转化成了驼峰式，所以没办法完成映射，也就拿==

==不到数据了！==

-----



**总结：规范自己的编码习惯，严格遵守Java关于多个单词组成变量名时的驼峰式命名规则！**

 